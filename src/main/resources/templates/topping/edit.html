<!DOCTYPE html>
<html  xmlns:th="http://www.thymeleaf.org">
<div th:replace="fragments/headTagSB"/>

<body id="page-top">

<!-- Page Wrapper -->
<div id="wrapper">

  <!-- Sidebar -->
  <div th:replace="fragments/sidebarSB"/>

  <!-- End of Sidebar -->

  <!-- Content Wrapper -->
  <div id="content-wrapper" class="d-flex flex-column">

    <!-- Main Content -->
    <div id="content">

      <!-- Topbar -->
      <div th:replace="fragments/topbarSB"/>
      <!-- End of Topbar -->

      <!-- Begin Page Content -->

      <div class="container-fluid">
        <div class="d-sm-flex align-items-center justify-content-between mb-4">
          <h1 class="h3 mb-0 text-gray-800">THÊM TOPPING MỚI ĐI CHỦ NHÂN</h1>
          <a href="/admin" class="d-none d-sm-inline-block btn btn-sm btn-primary shadow-sm">
            <i class="fas fa-arrow-left fa-sm text-white-50"></i> Back to Home </a>
        </div>
        <div class="row">
          <div class="col-xl-12 col-lg-8">
            <div class="card shadow mb-4">
              <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                <h6 class="m-0 font-weight-bold text-primary">Nhập Thông Tin</h6>
                <div class="dropdown no-arrow">
                  <a class="dropdown-toggle" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <i class="fas fa-ellipsis-v fa-sm fa-fw text-gray-400"></i>
                  </a>
                  <div class="dropdown-menu dropdown-menu-right shadow animated--fade-in" aria-labelledby="dropdownMenuLink">
                    <div class="dropdown-header">Dropdown Header:</div>
                    <a class="dropdown-item" href="#">Action</a>
                    <a class="dropdown-item" href="#">Another action</a>
                    <div class="dropdown-divider"></div>
                    <a class="dropdown-item" href="#">Something else here</a>
                  </div>
                </div>
              </div>
              <form method="post" action="/api/topping/add" enctype="multipart/form-data" th:object="${topping}">
                <input name="__RequestVerificationToken" type="hidden" value="your_token_here">
                <div class="card-body">
                  <div class="form-row">
                    <div class="form-group col-md-3">
                      <label for="ToppingName">Tên topping:</label>
                      <input type="text" id="ToppingName" name="toppingName" class="form-control" placeholder="Nhập tên topping">
                    </div>
                    <div class="form-group col-md-3">
                      <label for="price">Giá:</label>
                      <input type="number" id="price" name="price" class="form-control" th:field="*{toppingName}" placeholder="Nhập giá">
                    </div>
                    <div class="form-group col-md-3">
                      <label for="Unit">Đơn vị tính:</label>
                      <input type="text" id="unit" name="unit" class="form-control" placeholder="Nhập đơn vị tính">
                    </div>

                  </div>
                  <div class="form-group col-md-3">
                    <label for="image-input">Ảnh topping:</label>
                    <div class="custom-file">
                      <input type="file" class="custom-file-input" required="" accept="image/*" id="image-input" name="file">
                      <label class="custom-file-label" for="image-input">Choose file</label>
                    </div>
                    <div class="mt-3">
                      <img id="image-preview" class="img-thumbnail" width="120" height="120">
                    </div>
                  </div>
                  <script>
                    fetch('/api/topping')
                            .then(response => response.json())
                            .then(data => {
                              const tableBody = document.querySelector('#topping-table tbody');
                              for (const topping of data) {
                                const row = tableBody.insertRow();
                                const toppingNameCell = row.insertCell();
                                toppingNameCell.textContent = topping.toppingName;

                                const priceCell = row.insertCell();
                                priceCell.textContent = topping.price;

                                const unitCell = row.insertCell();
                                unitCell.textContent = topping.unit;
                              }
                            });
                  </script>
                  <script>
                    const imageInput = document.querySelector('#image-input');
                    const imagePreview = document.querySelector('#image-preview');
                    const dishname=document.querySelector('#dishName');
                    const uploadButton = document.querySelector('#upload-button');
                    imageInput.addEventListener('change', () => {
                      const file = imageInput.files[0];
                      if (file) {
                        const reader = new FileReader();
                        reader.onload = () => {
                          imagePreview.src = reader.result;
                        };
                        reader.readAsDataURL(file);
                      }
                    });
                    uploadButton.addEventListener('click', (event) => {
                      event.preventDefault(); // Prevent the default action of the button
                      const file = imageInput.files[0];
                      if (!file) {
                        // Display an error message if no file is selected
                        alert('Bạn phải chọn một hình ảnh trước khi tải lên!');
                        return;
                      }
                      const formData = new FormData();
                      formData.append('image', file);
                      formData.append('toppingName', toppingName.value); // Replace 'user_info' with the actual user info

                      fetch('/api/topping/add', {
                        method: 'POST',
                        body: formData
                      })
                              .then(response => response.json())
                              .then(data => {

                                document.getElementById("notification").innerHTML = "<div class='alert alert-success'>Thêm sản phẩm thành công!</div>";
                              })
                              .catch(error => {

                                document.getElementById("notification").innerHTML = "<div class='alert alert-danger'>Không thể thêm sản phẩm!</div>";
                              });
                    });
                  </script>
                  <button type="submit" class="btn btn-primary btn-icon-split btn-sm">
                          <span class="icon text-white-50">
                            <i class="fas fa-check"></i>
                          </span>
                    <span class="text">Thêm</span>
                  </button>
                  <h1 class="showno"></h1>
                  Các trường (*) là bắt buộc. Vui lòng điền đầy đủ!
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>

      <!-- /.container-fluid -->

    </div>
    <!-- End of Main Content -->

    <div th:replace="fragments/bottomPageSB"/>


  </div>
  <!-- End of Content Wrapper -->

</div>
<!-- End of Page Wrapper -->

<!-- Scroll to Top Button-->
<a class="scroll-to-top rounded" href="#page-top">
  <i class="fas fa-angle-up"></i>
</a>

<!-- Logout Modal-->
<div class="modal fade" id="logoutModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
     aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Ready to Leave?</h5>
        <button class="close" type="button" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">×</span>
        </button>
      </div>
      <div class="modal-body">Select "Logout" below if you are ready to end your current session.</div>
      <div class="modal-footer">
        <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>
        <a class="btn btn-primary" href="login.html">Logout</a>
      </div>
    </div>
  </div>
</div>

<!-- Bootstrap core JavaScript-->
<script src="vendor/jquery/jquery.min.js"></script>
<script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

<!-- Core plugin JavaScript-->
<script src="vendor/jquery-easing/jquery.easing.min.js"></script>

<!-- Custom scripts for all pages-->
<script src="js/sb-admin-2.min.js"></script>

<!-- Page level plugins -->
<script src="vendor/chart.js/Chart.min.js"></script>

<!-- Page level custom scripts -->
<script src="js/demo/chart-area-demo.js"></script>
<script src="js/demo/chart-pie-demo.js"></script>

</body>

</html>
      <!-- Begin Page Content -->





